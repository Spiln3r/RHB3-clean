      - name: Package build into ZIP
        shell: powershell
        env:
          PROJECT_DIR: ${{ env.PROJECT_DIR }}
          TAG: ${{ env.TAG }}
        run: |
          $project = if ($env:PROJECT_DIR -eq ".") { "." } else { $env:PROJECT_DIR }
          $release = Join-Path $project "build/windows/runner/Release"

          if (-not (Test-Path $release)) {
            Write-Error "❌ Release folder not found: $release"
            exit 1
          }

          $zipName = "windows-$($env:TAG).zip"
          $zipPath = Join-Path (Get-Location) $zipName

          if (Test-Path $zipPath) { Remove-Item $zipPath -Force }

          # build ZIP
          Compress-Archive -Path "$release\*" -DestinationPath $zipPath -Force

          # print path safely
          Write-Host "ZIP file created successfully:"
          Write-Host $zipPath

          # export variable to GITHUB_ENV
          Add-Content -Path $env:GITHUB_ENV -Value "ZIP_PATH=$zipPath"