<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>RHB3 - Monitor B3 (Web Styled)</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg: #0b0c0d;
      --panel: #151617;
      --panel-2: #1b1c1d;
      --accent-green: #1db954;
      --accent-red: #e14b4b;
      --muted: #bfc3c6;
      --glass: rgba(255,255,255,0.03);
      --card-border: rgba(255,255,255,0.04);
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{font-family:'Inter',system-ui,Arial,sans-serif;background:
      radial-gradient(1200px 600px at 10% 10%, rgba(0,0,0,0.35), transparent),
      var(--bg); color:#ecf0f1; -webkit-font-smoothing:antialiased; padding:28px}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px}
    .brand{display:flex;align-items:center;gap:18px}
    .brand img{width:84px;height:84px;object-fit:cover;border-radius:6px;box-shadow:0 6px 18px rgba(0,0,0,0.6)}
    .brand h1{font-size:48px;letter-spacing:1px;font-weight:800;margin-left:6px}
    .top-actions{display:flex;gap:14px;align-items:center}
    .pill-btn{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);border:1px solid rgba(255,255,255,0.04);padding:12px 28px;border-radius:10px;color:#eee;font-weight:600;cursor:pointer;box-shadow:inset 0 -2px 0 rgba(0,0,0,0.4)}
    .pill-btn.active{background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));box-shadow:0 8px 20px rgba(0,0,0,0.6)}
    .container{display:grid;grid-template-columns:repeat(3,1fr);gap:18px}
    .card{background:linear-gradient(180deg,var(--panel),var(--panel-2));border:1px solid var(--card-border);padding:12px;border-radius:6px;box-shadow:0 6px 18px rgba(0,0,0,0.6)}
    .card-header{display:flex;justify-content:space-between;align-items:center;padding:8px 12px;margin-bottom:6px;background:rgba(0,0,0,0.25);border-radius:4px}
    .card-header .title{font-weight:700;color:#e9ecef}
    .card-table{width:100%;border-collapse:collapse}
    .card-row{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-bottom:1px solid rgba(255,255,255,0.02)}
    .card-row .left{display:flex;gap:14px;align-items:center}
    .ticker{font-weight:800;font-size:18px;letter-spacing:0.6px}
    .price{min-width:80px;text-align:right;font-weight:600}
    .var{min-width:84px;text-align:right;font-weight:700}
    .small{font-size:12px;color:var(--muted)}
    .var.positive{color:var(--accent-green)}
    .var.negative{color:var(--accent-red)}
    .footer-note{
      margin-top:8px;color:var(--muted);font-size:13px;text-align:right;padding-right:6px
    }

    /* responsive */
    @media (max-width:1100px) {
      .container{grid-template-columns:repeat(2,1fr)}
      .brand h1{font-size:36px}
    }
    @media (max-width:700px) {
      body{padding:14px}
      header{flex-direction:column;align-items:flex-start;gap:12px}
      .container{grid-template-columns:1fr}
      .brand h1{font-size:28px}
      .brand img{width:56px;height:56px}
    }
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <img src="{logo_path}" alt="logo"/>
<div id="rhb3-search" style="display:flex;align-items:center;margin-left:14px;">
  <div style="position:relative;">
    <svg width="14" height="14" viewBox="0 0 24 24" style="position:absolute;left:10px;top:50%;transform:translateY(-50%);opacity:0.7;color:#bfc7cc;"><path fill="currentColor" d="M15.5 14h-.79l-.28-.27A6.471..."/></svg>
    <input id="rhb3-search-input" placeholder="Pesquisar ativo" style="width:260px;padding:6px 10px 6px 34px;border-radius:6px;border:1px solid rgba(255,255,255,0.06);background:rgba(255,255,255,0.02);color:#fff;font-size:13px;height:28px;">
    <div id="rhb3-search-suggestions" style="position:absolute;top:34px;left:0;right:0;z-index:9999;display:none;background:#111;border:1px solid #222;border-radius:6px;max-height:200px;overflow:auto;"></div>
  </div>
</div>

      <h1>RHB3</h1>
    </div>
    <div class="top-actions">
      <button class="pill-btn active">Ações</button>
      <button class="pill-btn">FIIs</button>
      <button class="pill-btn">Cripto</button>
      <button class="pill-btn">ETFs</button>
    </div>
  </header>

  <main class="container" id="cardsGrid">
    <!-- Cards inserted by JS -->
  </main>

  <div class="footer-note">Demo — dados mock. Layout inspirado na sua imagem.</div>

<script>
let TICKERS = [];

/* mock dataset for cards: build 6 cards each with a few tickers to show layout */
const INITIAL_CARDS = [
  {title:'Ações', cols:['ticker','price','var','vt'], items:['PETR4','VALE3','JBSS3','FPT31','FPTR11','STIB11','TAEE11','CTC90']},
  {title:'FIIs', cols:['ticker','price','var','ult'], items:['MXRF11','BTSY11','ODDEB','NDRT11','TRRB11','MTBOS','TDTB1','CTZM10']},
  {title:'Cripto', cols:['ticker','price','var','ult'], items:['MXRF11','BCHG11','BCHG11','CHOG11','COX11','MTC18','PUO11','BTCUSD']},
  {title:'Ações 2', cols:['ticker','price','var','ult'], items:['AURE4','DFST2','NU74','KBN1','KFT131','FCR12','PRF11','PIDI21']},
  {title:'FIIs', cols:['ticker','price','var','ult'], items:['AURE4','BCGH7','FIDBLQ','KPGR1','KHT74','MTHT1','OTER1','OKOC7']},
  {title:'ETFs', cols:['ticker','price','var','ult'], items:['PID12','PEC1','TIRF11','UBD11','MKT70','MKE10','HKT1','BTCUSD']},
];

function mockPrice(t){
  var s=0;
  for(var i=0;i<t.length;i++){ s+=t.charCodeAt(i); }
  var base = (s % 200) + (t.length * 3);
  var vol = ((s % 11)-5)/100;
  return {
    price: (Math.round(base*(1+vol)*100)/100).toLocaleString('pt-BR'),
    var: (Math.round(vol*100*100)/100)
  };
}

function renderCard(card){
  var div = document.createElement('div');
  div.className='card';
  var header = document.createElement('div');
  header.className='card-header';
  header.innerHTML = '<div class="title">'+card.title+'</div><div class="small">Modo Janela &nbsp;&nbsp; Preço &nbsp;&nbsp; Var% &nbsp;&nbsp; Últ</div>';
  div.appendChild(header);
  for(var i=0;i<card.items.length;i++){
    var t = card.items[i];
    var info = TICKERS.find(function(x){return x.ticker===t}) || {ticker:t,name:''};
    var m = mockPrice(t);
    var row = document.createElement('div');
    row.className='card-row';
    row.innerHTML = '<div class="left"><div style="width:140px"><div class="ticker">'+info.ticker+'</div><div class="small">'+info.name+'</div></div></div><div style="display:flex;flex-direction:column;align-items:flex-end"><div class="price">R$ '+m.price+'</div><div class="var '+(m.var>=0?'positive':'negative')+'">'+(m.var>=0?'+':'')+m.var+'%</div></div>';
    div.appendChild(row);
  }
  return div;
}

function renderGrid(){
  var grid = document.getElementById('cardsGrid');
  grid.innerHTML='';
  for(var i=0;i<INITIAL_CARDS.length;i++){
    grid.appendChild(renderCard(INITIAL_CARDS[i]));
  }
}

// renderGrid(); -- deferred to after tickers load

// Load the full tickers list asynchronously to avoid huge initial HTML payload
fetch('./b3_tickers_full.json')
  .then(response => {
    if (!response.ok) throw new Error('Falha ao carregar tickers: ' + response.status);
    return response.json();
  })
  .then(data => {
    TICKERS = data;
    console.info('B3 tickers loaded:', TICKERS.length);
    // now render the grid with the full tickers list available
    renderGrid();
  })
  .catch(err => {
    console.error(err);
    // still render grid so UI is usable (with local mock tickers)
    renderGrid();
  });


</script>
<script>
(() => {
 const input=document.getElementById('rhb3-search-input');
 const sug=document.getElementById('rhb3-search-suggestions');
 let T=[]; fetch('./b3_tickers_full.json').then(r=>r.json()).then(j=>T=j);
 input.addEventListener('input',e=>{
  const v=e.target.value.toUpperCase().trim();
  if(!v){sug.style.display='none';return;}
  const out=T.filter(x=>x.ticker.startsWith(v)).slice(0,30);
  sug.innerHTML=out.map(x=>`<div data-t="${x.ticker}" style="padding:6px 10px;cursor:pointer;">${x.ticker} - ${x.name}</div>`).join('');
  sug.style.display='block';
  sug.querySelectorAll('div').forEach(d=>d.onclick=()=>{input.value=d.dataset.t; sug.style.display='none';});
 });
})();
</script>

</body>
</html>
